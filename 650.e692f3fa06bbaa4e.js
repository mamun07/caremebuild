"use strict";(self.webpackChunkui=self.webpackChunkui||[]).push([[650],{20650:(F,u,o)=>{o.r(u),o.d(u,{TicketDetailsPageModule:()=>J});var M=o(83626),P=o(90898),r=o(41894),c=o(69808),s=o(93075),t=o(5e3),C=o(71857),g=o(99826),O=o(49727),x=o(5944),v=o(61293),p=o(77484),m=o(76042),z=o(82683),T=o(92643),d=o(98706),h=o(11047),Z=o(76699);function k(i,a){if(1&i&&(t.TgZ(0,"div",22)(1,"p"),t._uU(2),t.ALo(3,"date"),t.qZA()()),2&i){const n=t.oxw().$implicit;t.xp6(2),t.Oqu(t.xi3(3,1,null==n?null:n.date,"shortTime"))}}function y(i,a){if(1&i&&(t.TgZ(0,"div",22),t._UZ(1,"nz-avatar",23),t.TgZ(2,"p"),t._uU(3),t.ALo(4,"date"),t.qZA()()),2&i){const n=t.oxw().$implicit,e=t.oxw();t.xp6(1),t.Q6J("nzSrc",null!=e.user&&e.user.profileImg?e.user.profileImg:"../../../../assets/images/placeholder/test.png"),t.xp6(2),t.Oqu(t.xi3(4,2,null==n?null:n.date,"shortTime"))}}function b(i,a){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,k,4,4,"div",21),t.TgZ(2,"ul")(3,"li"),t._uU(4),t.qZA()(),t.YNc(5,y,5,5,"div",21),t.qZA()),2&i){const n=a.$implicit;t.Tol("Customer"===n.type?"customer":"admin"),t.xp6(1),t.Q6J("ngIf","Admin"===(null==n?null:n.type)),t.xp6(3),t.Oqu(null==n?null:n.msg),t.xp6(1),t.Q6J("ngIf","Customer"===(null==n?null:n.type))}}const _=function(){return{span:24}},A=function(){return{span:18}},U=function(){return{span:6}};let f=(()=>{class i{constructor(n,e,l,j,w,Q){this.ticketService=n,this.activatedRoute=e,this.msg=l,this.userDataService=j,this.fb=w,this.reloadService=Q,this.date=new Date}ngOnInit(){this.getCustomerInfo(),this.subRouteOne=this.activatedRoute.paramMap.subscribe(n=>{this.id=n.get("id"),this.id&&this.getById()}),this.reloadService.refreshTickets$.subscribe(()=>{this.getById(),this.getCustomerInfo(),this.initModule()}),this.initModule()}initModule(){this.dataForm=this.fb.group({attachments:[null],msg:[null,s.kI.required]})}getCustomerInfo(){this.userDataService.getLoggedInUserInfo().subscribe(n=>{this.user=n.data,console.log(this.user)},n=>{this.msg.error(n.message)})}getById(){this.ticketService.getById(this.id).subscribe(n=>{this.ticket=n.data,console.log(this.ticket)},n=>{this.msg.error(n.message)})}addMessageByUser(){if(this.dataForm.invalid)return void this.msg.warning("Please write your messsage first");let n={msg:this.dataForm.value.msg,type:"Customer",userId:this.user._id,date:new Date,attachemnts:[]};this.ticketService.addMessage(n,this.ticket._id).subscribe(e=>{this.reloadService.needRefreshTickets$()},e=>{this.msg.error(e.message)})}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(C.w),t.Y36(g.gz),t.Y36(O.dD),t.Y36(x.M),t.Y36(s.qu),t.Y36(v.f))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-ticket-details-page"]],decls:56,vars:24,consts:[["nz-row",""],["nz-col","","nzSpan","24"],[1,"card_head"],[1,"card_head-info"],["nz-button","","nzType","default",3,"disabled"],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzXs","nzMd"],[1,"ticket_details"],[1,"ticket_chat"],["nzSize","small"],[1,"chat_content",3,"scrollTop"],["scrollMe",""],[3,"class",4,"ngFor","ngForOf"],[1,"chat_action",3,"formGroup","ngSubmit"],["nz-input","","placeholder","Enter your message here","nzSize","large","formControlName","msg"],[1,"fa-solid","fa-paperclip"],["type","submit",2,"background","none","border","none",3,"disabled"],[1,"fa-solid","fa-paper-plane"],[1,"att_image"],[1,"images"],["nz-image","","nzSrc","https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png","alt",""],["class","chatprof",4,"ngIf"],[1,"chatprof"],["nzSize","small","nzIcon","user",3,"nzSrc"]],template:function(n,e){if(1&n&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",1)(3,"nz-card")(4,"div",2)(5,"div",3)(6,"h3"),t._uU(7),t.qZA(),t.TgZ(8,"h5"),t._uU(9),t.ALo(10,"date"),t.qZA()(),t.TgZ(11,"button",4),t._uU(12),t.qZA()(),t.TgZ(13,"div",5)(14,"div",6)(15,"div",7)(16,"ul")(17,"li")(18,"h4")(19,"span"),t._uU(20,"Products SKU"),t.qZA(),t._uU(21),t.qZA(),t.TgZ(22,"h4")(23,"span"),t._uU(24,"Order ID"),t.qZA(),t._uU(25),t.qZA(),t.TgZ(26,"h4")(27,"span"),t._uU(28,"Issue Type"),t.qZA(),t._uU(29),t.qZA(),t.TgZ(30,"h4")(31,"span"),t._uU(32,"Message"),t.qZA(),t._uU(33),t.qZA()()()(),t.TgZ(34,"div",8)(35,"nz-card",9)(36,"div",10,11),t.YNc(38,b,6,5,"div",12),t.qZA(),t.TgZ(39,"form",13),t.NdJ("ngSubmit",function(){return e.addMessageByUser()}),t._UZ(40,"input",14),t.TgZ(41,"ul")(42,"li"),t._UZ(43,"i",15),t.qZA(),t.TgZ(44,"li")(45,"button",16),t._UZ(46,"i",17),t.qZA()()()()()()(),t.TgZ(47,"div",6)(48,"div",18)(49,"h1"),t._uU(50,"Your Attachments"),t.qZA(),t.TgZ(51,"nz-image-group",19),t._UZ(52,"img",20)(53,"img",20)(54,"img",20)(55,"img",20),t.qZA()()()()()()()),2&n){const l=t.MAs(37);t.xp6(7),t.hij("#",null==e.ticket?null:e.ticket.ticketId,""),t.xp6(2),t.Oqu(t.xi3(10,17,null==e.ticket?null:e.ticket.createdAt,"short")),t.xp6(2),t.Q6J("disabled",1===(null==e.ticket?null:e.ticket.status)),t.xp6(1),t.Oqu(1===e.ticket.status?"Closed":"Open"),t.xp6(1),t.Q6J("nzGutter",16),t.xp6(1),t.Q6J("nzXs",t.DdM(20,_))("nzMd",t.DdM(21,A)),t.xp6(7),t.hij(" : ",null==e.ticket?null:e.ticket.productIds,""),t.xp6(4),t.hij(" : ",null==e.ticket||null==e.ticket.orderNo?null:e.ticket.orderNo.orderId,""),t.xp6(4),t.hij(" : ",null==e.ticket?null:e.ticket.issueType," issue"),t.xp6(4),t.hij(" : ",null==e.ticket?null:e.ticket.message," "),t.xp6(3),t.Q6J("scrollTop",l.scrollHeight),t.xp6(2),t.Q6J("ngForOf",null==e.ticket?null:e.ticket.chats),t.xp6(1),t.Q6J("formGroup",e.dataForm),t.xp6(6),t.Q6J("disabled",1===(null==e.ticket?null:e.ticket.status)),t.xp6(2),t.Q6J("nzXs",t.DdM(22,_))("nzMd",t.DdM(23,U))}},dependencies:[c.sg,c.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,p.bd,m.ix,z.w,T.dQ,r.t3,r.SK,d.Ie,d.I7,h.Zp,Z.Dz,c.uU],styles:[".card_head[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-direction:row;border-bottom:1px solid #ddd;padding-bottom:15px;margin-bottom:30px}.att_image[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px}@media (max-width: 500px){.att_image[_ngcontent-%COMP%]{margin-top:30px}}.att_image[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{margin-top:20px}.att_image[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 5px 5px 0;display:inline-block;width:45%;cursor:pointer}.ticket_details[_ngcontent-%COMP%]{margin-bottom:30px}.ticket_details[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none}.ticket_details[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{min-width:120px;display:inline-block}.chat_action[_ngcontent-%COMP%]{display:flex;position:relative;align-items:center}.chat_action[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;height:60px}.chat_action[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:absolute;right:0;margin:0}.chat_action[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none;border-radius:100%;text-align:center;float:left;display:flex;align-items:center;width:40px;height:40px;justify-content:center;background:rgb(245,245,245);margin-right:5px;cursor:pointer;transition:.3s}.chat_action[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}.chat_action[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{background:#00662e;color:#eee}.chat_action[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#a32e72;color:#eee}.chat_content[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid #f8f8f8;background:#f8f8f8;margin-bottom:20px;padding:50px;max-height:300px;overflow:scroll}@media (max-width: 500px){.chat_content[_ngcontent-%COMP%]{background:#ffffff;padding:0}}.chat_content[_ngcontent-%COMP%]   .admin[_ngcontent-%COMP%]{display:flex;justify-content:last baseline;align-items:flex-start;flex-direction:row}.chat_content[_ngcontent-%COMP%]   .admin[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:5px 0 0 10px;border-radius:15px;overflow:hidden}.chat_content[_ngcontent-%COMP%]   .admin[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{max-width:100%;padding:3px 10px;list-style:none;margin-bottom:2px;text-align:left}.chat_content[_ngcontent-%COMP%]   .admin[_ngcontent-%COMP%]   .chatprof[_ngcontent-%COMP%]{text-align:center}.chat_content[_ngcontent-%COMP%]   .admin[_ngcontent-%COMP%]   .chatprof[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;padding:10px 0 0;color:#626262}.chat_content[_ngcontent-%COMP%]   .admin[_ngcontent-%COMP%]   .chatprof[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:100%}.chat_content[_ngcontent-%COMP%]   .customer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:flex-start;flex-direction:row}.chat_content[_ngcontent-%COMP%]   .customer[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:5px 10px 0 0;border-radius:15px;overflow:hidden}.chat_content[_ngcontent-%COMP%]   .customer[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{max-width:100%;padding:3px 10px;list-style:none;margin-bottom:2px;text-align:right}.chat_content[_ngcontent-%COMP%]   .chatprof[_ngcontent-%COMP%]{text-align:center}.chat_content[_ngcontent-%COMP%]   .chatprof[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;padding:10px 0 0;color:#626262}.chat_content[_ngcontent-%COMP%]   .chatprof[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:100%}"]}),i})();const D=[{path:"",component:f},{path:":id",component:f}];let I=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[g.Bz.forChild(D),g.Bz]}),i})();var S=o(92124);let J=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[c.ez,I,P.q,p.vh,m.sL,r.Jb,d.Gb,h.o7,S.PV,M.P]}),i})()}}]);